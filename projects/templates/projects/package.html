{% extends "base.html" %}
{% load counter %}
{% load filter %}
{% block title %}Projects{% endblock %}
{% block navbar_projects %}class="active"{% endblock %}
{% block content %}


<h2>Details of Package {{package.project.user.get_username}}:{{package.project.name}}:{{package.name}}</h2>

<ul>
  <li><a href="{{package.project.git_url}}/tree/{{package.project.git_branch}}/{{package.name}}" target="_blank">Project sources</a></li>

  {% for branchname in package.get_branches %}
  {% for buildtarget in package.get_buildtargets %}

  <a name="{{branchname}}_{{buildtarget}}"></a><br/><br/><br/>
  <a href="#{{branchname}}_{{buildtarget}}">
    {% if package.get_branches|length == 1 %}
    <h4>{{buildtarget|replace:"__|/"}}</h4>
    {% else %}
    <h4>{{branchname}} - {{buildtarget}}|replace:"__|/"</h4>
    {% endif %}
  </a>
  <ul>
    <li><a href="{% url "builder:triggerbuild" package.project.user.get_username package.project.name package.name branchname buildtarget %}">Trigger build</a></li>
  </ul>

  {% endfor %}
  {% endfor %}
  {% comment %}
                  <li><a href="{{package['buildurl']}}/{{branchname}}/{{buildtarget}}">Trigger build</a></li>
      <li><a href="/livelog/{{username}}/{{projectname}}/{{packagename}}/{{branchname}}/{{buildtarget}}">view current build</a></li>
      <li>Build history and logs:<ul>
        % for buildnumber in package['logs'][buildtarget+"-"+branchname]:
        <li class="{{package['logs'][buildtarget+"-"+branchname][buildnumber]["resultcode"]}}"> 
          <a href="/logs/{{username}}/{{projectname}}/{{packagename}}/{{branchname}}/{{buildtarget}}/{{buildnumber}}">log of build {{buildnumber}}</a> {{package['logs'][buildtarget+"-"+branchname][buildnumber]["timefinished"]}}
          &nbsp;
          {{"Succeeded" if package['logs'][buildtarget+"-"+branchname][buildnumber]["resultcode"] == "success" else "Failure"}}
        </li>
        % end  
      </ul></li>
      % if buildtarget in package['repoinstructions'] and package['repoinstructions'][buildtarget] is not None:
        <li>Installation instructions:
        <pre>{{package['repoinstructions'][buildtarget]}}</pre>
        </li>
      % end
      % if buildtarget in package['srcinstructions'] and package['srcinstructions'][buildtarget] is not None:
        <li>Download Source package:
        <a href="{{package['srcinstructions'][buildtarget][0]}}">{{package['srcinstructions'][buildtarget][1]}}</a>
        </li>
      % end
      % if branchname in package['wininstructions'] and package['wininstructions'][branchname] is not None:
        <li>Download Windows Installer:
        <a href="{{package['wininstructions'][branchname][0]}}">{{package['wininstructions'][branchname][1]}}</a>
        </li>
      % end
  {% endcomment %}
</ul>


{% endblock %}
